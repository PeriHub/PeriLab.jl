<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solver · PeriLab</title><meta name="title" content="Solver · PeriLab"/><meta property="og:title" content="Solver · PeriLab"/><meta property="twitter:title" content="Solver · PeriLab"/><meta name="description" content="Documentation for PeriLab."/><meta property="og:description" content="Documentation for PeriLab."/><meta property="twitter:description" content="Documentation for PeriLab."/><meta property="og:url" content="https://github.com/PeriHub/PeriLab.jl/lib/solver_functions/"/><meta property="twitter:url" content="https://github.com/PeriHub/PeriLab.jl/lib/solver_functions/"/><link rel="canonical" href="https://github.com/PeriHub/PeriLab.jl/lib/solver_functions/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="PeriLab logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="PeriLab logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PeriLab</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../man/basics/">First Steps with PeriLab</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../man/getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../man/input_yaml/">Input File</a></li><li><a class="tocitem" href="../../man/mesh_input/">Mesh and Nodesets</a></li><li><a class="tocitem" href="../../man/bond_filter/">Bond-Filter</a></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/models/overview/">Overview</a></li><li><a class="tocitem" href="../../man/models/materials/">Material Models</a></li><li><a class="tocitem" href="../../man/models/damage/">Damage Models</a></li><li><a class="tocitem" href="../../man/models/thermal/">Thermal Models</a></li><li><a class="tocitem" href="../../man/models/additive/">Additive Models</a></li><li><a class="tocitem" href="../../man/models/contact/">Contact Models</a></li></ul></li><li><a class="tocitem" href="../../man/output/">Output</a></li><li><a class="tocitem" href="../../man/solver/solver/">Solver</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/theory/">Basics</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Peridynamic Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_bondbased/">Bond-based</a></li><li><a class="tocitem" href="../../theory/theory_ordinary/">Ordinary state-based</a></li><li><a class="tocitem" href="../../theory/theory_correspondence/">Non-Ordinary state-based</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Multi-Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_thermal/">Thermal Models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Finite Element Method</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_FEM/">FEM</a></li><li><a class="tocitem" href="../../theory/theory_FEM_PD_coupling/">Finite Element - Peridynamics coupling</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Modelling strategies</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_surface_correction/">Surface Correction</a></li></ul></li></ul></li><li><span class="tocitem">Lecture</span><ul><li><a class="tocitem" href="../../lecture/lecture/">Non-local structural mechanics and peridynamics</a></li><li><a class="tocitem" href="../../lecture/seminar_1/">Seminar 1</a></li><li><a class="tocitem" href="../../lecture/seminar_2/">Seminar 2</a></li><li><a class="tocitem" href="../../lecture/seminar_3/">Seminar 3</a></li><li><a class="tocitem" href="../../lecture/seminar_4/">Seminar 4</a></li></ul></li><li><a class="tocitem" href="../faq/">FAQ</a></li><li><a class="tocitem" href="../glossar/">Glossar</a></li><li><a class="tocitem" href="../references/">References</a></li><li><a class="tocitem" href="../links/">Useful Links</a></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="../../man/dev/developement_guide/">Guide</a></li><li><a class="tocitem" href="../../man/dev/datamanager/">Datamanager</a></li><li><a class="tocitem" href="../../man/dev/module_integration/">Module integration</a></li><li><a class="tocitem" href="../../man/dev/testing/">Software Testing</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../model_factory_functions/">Model Factory</a></li><li><a class="tocitem" href="../data_manager_functions/">Data Manager</a></li><li class="is-active"><a class="tocitem" href>Solver</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Solver"><span>Solver</span></a></li><li><a class="tocitem" href="#Verlet"><span>Verlet</span></a></li><li><a class="tocitem" href="#Boundary_conditions"><span>Boundary_conditions</span></a></li></ul></li><li><a class="tocitem" href="../io_functions/">IO</a></li><li><a class="tocitem" href="../geometry_functions/">Geometry</a></li><li><a class="tocitem" href="../mpi_functions/">MPI</a></li><li><a class="tocitem" href="../helper_functions/">Helper</a></li><li><a class="tocitem" href="../logging_functions/">Logging</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solver</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PeriHub/PeriLab.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PeriHub/PeriLab.jl/blob/main/docs/src/lib/solver_functions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solver-Functions"><a class="docs-heading-anchor" href="#Solver-Functions">Solver - Functions</a><a id="Solver-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Solver-Functions" title="Permalink"></a></h1><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#PeriLab.Solver_control.Boundary_conditions.apply_bc_dirichlet-Tuple{Vector{String}, Dict, Module, Float64, Float64}"><code>PeriLab.Solver_control.Boundary_conditions.apply_bc_dirichlet</code></a></li><li><a href="#PeriLab.Solver_control.Boundary_conditions.apply_bc_neumann-Tuple{Dict, Module, Float64, Float64}"><code>PeriLab.Solver_control.Boundary_conditions.apply_bc_neumann</code></a></li><li><a href="#PeriLab.Solver_control.Boundary_conditions.boundary_condition-Tuple{Dict, Any}"><code>PeriLab.Solver_control.Boundary_conditions.boundary_condition</code></a></li><li><a href="#PeriLab.Solver_control.Boundary_conditions.check_valid_bcs-Tuple{Dict{String, Any}, Module}"><code>PeriLab.Solver_control.Boundary_conditions.check_valid_bcs</code></a></li><li><a href="#PeriLab.Solver_control.Boundary_conditions.clean_up-Tuple{String}"><code>PeriLab.Solver_control.Boundary_conditions.clean_up</code></a></li><li><a href="#PeriLab.Solver_control.Boundary_conditions.eval_bc!"><code>PeriLab.Solver_control.Boundary_conditions.eval_bc!</code></a></li><li><a href="#PeriLab.Solver_control.Boundary_conditions.find_bc_free_dof-Tuple{Module, Dict{Any, Any}}"><code>PeriLab.Solver_control.Boundary_conditions.find_bc_free_dof</code></a></li><li><a href="#PeriLab.Solver_control.Boundary_conditions.init_BCs-Tuple{Dict, Any}"><code>PeriLab.Solver_control.Boundary_conditions.init_BCs</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.calculate_strain-Tuple{Module, Union{SubArray, Vector{Int64}}, Union{Matrix{Float64}, StaticArraysCore.SMatrix, StaticArraysCore.MMatrix}}"><code>PeriLab.Solver_control.Verlet.calculate_strain</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.calculate_stresses-Tuple{Module, Dict{Int64, Vector{Int64}}, Dict{String, Any}}"><code>PeriLab.Solver_control.Verlet.calculate_stresses</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.calculate_von_mises_stress-Tuple{Module, Union{SubArray, Vector{Int64}}}"><code>PeriLab.Solver_control.Verlet.calculate_von_mises_stress</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.compute_crititical_time_step-Tuple{Module, Dict{Int64, Vector{Int64}}, Bool, Bool}"><code>PeriLab.Solver_control.Verlet.compute_crititical_time_step</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.compute_mechanical_critical_time_step-Tuple{Union{SubArray, Vector{Int64}}, Module, Union{Float64, Int64, SubArray, Vector{Float64}}}"><code>PeriLab.Solver_control.Verlet.compute_mechanical_critical_time_step</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.compute_thermodynamic_critical_time_step-Tuple{Union{SubArray, Vector{Int64}}, Module, Union{Float64, Int64}}"><code>PeriLab.Solver_control.Verlet.compute_thermodynamic_critical_time_step</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.get_cs_denominator-Tuple{Union{Vector{Float64}, Vector{Int64}, SubArray}, Union{Vector{Float64}, Vector{Int64}, SubArray}}"><code>PeriLab.Solver_control.Verlet.get_cs_denominator</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.get_forces_from_force_density-Tuple{Module}"><code>PeriLab.Solver_control.Verlet.get_forces_from_force_density</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.get_integration_steps-Tuple{Float64, Float64, Float64}"><code>PeriLab.Solver_control.Verlet.get_integration_steps</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.get_partial_stresses-Tuple{Module, Union{SubArray, Vector{Int64}}}"><code>PeriLab.Solver_control.Verlet.get_partial_stresses</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.init_solver-Tuple{Dict{Any, Any}, Dict, Dict{Any, Any}, Module, Dict{Int64, Vector{Int64}}}"><code>PeriLab.Solver_control.Verlet.init_solver</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.run_solver-Tuple{Dict{Any, Any}, Dict{Int64, Vector{Int64}}, Dict{Any, Any}, Module, Dict{Int64, Dict}, Vector{Dict}, Any, Any, Any, Any, TimerOutputs.TimerOutput, Bool}"><code>PeriLab.Solver_control.Verlet.run_solver</code></a></li><li><a href="#PeriLab.Solver_control.Verlet.test_timestep-Tuple{Float64, Float64}"><code>PeriLab.Solver_control.Verlet.test_timestep</code></a></li><li><a href="#PeriLab.Solver_control.init"><code>PeriLab.Solver_control.init</code></a></li><li><a href="#PeriLab.Solver_control.remove_models-Tuple{Module, Vector{String}}"><code>PeriLab.Solver_control.remove_models</code></a></li><li><a href="#PeriLab.Solver_control.set_angles-Tuple{Module, Dict, Dict}"><code>PeriLab.Solver_control.set_angles</code></a></li><li><a href="#PeriLab.Solver_control.set_density-Tuple{Dict, Dict, Vector{Float64}}"><code>PeriLab.Solver_control.set_density</code></a></li><li><a href="#PeriLab.Solver_control.set_fem_block-Tuple{Dict, Dict, Vector{Bool}}"><code>PeriLab.Solver_control.set_fem_block</code></a></li><li><a href="#PeriLab.Solver_control.set_horizon-Tuple{Dict, Dict, Vector{Float64}}"><code>PeriLab.Solver_control.set_horizon</code></a></li><li><a href="#PeriLab.Solver_control.solver-Tuple{Dict{Any, Any}, Dict{Int64, Vector{Int64}}, Dict{Any, Any}, Module, Dict{Int64, Dict}, Vector{Dict}, Any, Any, Bool}"><code>PeriLab.Solver_control.solver</code></a></li><li><a href="#PeriLab.Solver_control.synchronise_field-Tuple{Any, Dict, Any, Any, String, String}"><code>PeriLab.Solver_control.synchronise_field</code></a></li></ul><h2 id="Solver"><a class="docs-heading-anchor" href="#Solver">Solver</a><a id="Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Solver" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.init" href="#PeriLab.Solver_control.init"><code>PeriLab.Solver_control.init</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init(params::Dict, datamanager::Module)</code></pre><p>Initialize the solver</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict</code>: The parameters</li><li><code>datamanager::Module</code>: Datamanager</li><li><code>to::TimerOutputs.TimerOutput</code>: A timer output</li></ul><p><strong>Returns</strong></p><ul><li><code>block_nodes::Dict{Int64,Vector{Int64}}</code>: A dictionary mapping block IDs to collections of nodes.</li><li><code>bcs::Dict{Any,Any}</code>: A dictionary containing boundary conditions.</li><li><code>datamanager::Module</code>: The data manager module that provides access to data fields and properties.</li><li><code>solver_options::Dict{String,Any}</code>: A dictionary containing solver options.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L43-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.remove_models-Tuple{Module, Vector{String}}" href="#PeriLab.Solver_control.remove_models-Tuple{Module, Vector{String}}"><code>PeriLab.Solver_control.remove_models</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remove_models(datamanager::Module, solver_options::Vector{String})</code></pre><p>Sets the active models to false if they are deactivated in the solver. They can be active, because they are defined as model and in the blocks.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Module</code>: The MPI communicator</li><li><code>solver_options::Vector{String}</code>: A dictionary of fields</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L358-L368">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.set_angles-Tuple{Module, Dict, Dict}" href="#PeriLab.Solver_control.set_angles-Tuple{Module, Dict, Dict}"><code>PeriLab.Solver_control.set_angles</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_angles(datamanager::Module, params::Dict, block_nodes::Dict)</code></pre><p>Sets the density of the nodes in the dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Module</code>: The data manager</li><li><code>params::Dict</code>: The parameters</li><li><code>block_nodes::Dict</code>: A dictionary mapping block IDs to collections of nodes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L172-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.set_density-Tuple{Dict, Dict, Vector{Float64}}" href="#PeriLab.Solver_control.set_density-Tuple{Dict, Dict, Vector{Float64}}"><code>PeriLab.Solver_control.set_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_density(params::Dict, block_nodes::Dict, density::Vector{Float64})</code></pre><p>Sets the density of the nodes in the dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict</code>: The parameters</li><li><code>block_nodes::Dict</code>: A dictionary mapping block IDs to collections of nodes</li><li><code>density::Vector{Float64}</code>: The density</li></ul><p><strong>Returns</strong></p><ul><li><code>density::Vector{Float64}</code>: The density</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L153-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.set_fem_block-Tuple{Dict, Dict, Vector{Bool}}" href="#PeriLab.Solver_control.set_fem_block-Tuple{Dict, Dict, Vector{Bool}}"><code>PeriLab.Solver_control.set_fem_block</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_fem_block(params::Dict, block_nodes::Dict, fem_block::Vector{Bool})</code></pre><p>Sets the fem_block of the nodes in the dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict</code>: The parameters</li><li><code>block_nodes::Dict</code>: A dictionary mapping block IDs to collections of nodes</li><li><code>fem_block::Vector{Bool}</code>: The fem_block</li></ul><p><strong>Returns</strong></p><ul><li><code>fem_block::Vector{Bool}</code>: The fem_block</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L207-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.set_horizon-Tuple{Dict, Dict, Vector{Float64}}" href="#PeriLab.Solver_control.set_horizon-Tuple{Dict, Dict, Vector{Float64}}"><code>PeriLab.Solver_control.set_horizon</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_horizon(params::Dict, block_nodes::Dict, horizon::Vector{Float64})</code></pre><p>Sets the horizon of the nodes in the dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict</code>: The parameters</li><li><code>block_nodes::Dict</code>: A dictionary mapping block IDs to collections of nodes</li><li><code>horizon::Vector{Float64}</code>: The horizon</li></ul><p><strong>Returns</strong></p><ul><li><code>horizon::Vector{Float64}</code>: The horizon</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L226-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.solver-Tuple{Dict{Any, Any}, Dict{Int64, Vector{Int64}}, Dict{Any, Any}, Module, Dict{Int64, Dict}, Vector{Dict}, Any, Any, Bool}" href="#PeriLab.Solver_control.solver-Tuple{Dict{Any, Any}, Dict{Int64, Vector{Int64}}, Dict{Any, Any}, Module, Dict{Int64, Dict}, Vector{Dict}, Any, Any, Bool}"><code>PeriLab.Solver_control.solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solver(solver_options::Dict{String,Any}, block_nodes::Dict{Int64,Vector{Int64}}, bcs::Dict{Any,Any}, datamanager::Module, outputs::Dict{Int64,Dict{}}, result_files::Vector{Any}, write_results, to, silent::Bool)</code></pre><p>Runs the solver.</p><p><strong>Arguments</strong></p><ul><li><code>solver_options::Dict{String,Any}</code>: The solver options</li><li><code>block_nodes::Dict{Int64,Vector{Int64}}</code>: A dictionary mapping block IDs to collections of nodes</li><li><code>bcs::Dict{Any,Any}</code>: The boundary conditions</li><li><code>datamanager::Module</code>: The data manager module</li><li><code>outputs::Dict{Int64,Dict{}}</code>: A dictionary for output settings</li><li><code>result_files::Vector{Any}</code>: A vector of result files</li><li><code>write_results</code>: A function to write simulation results</li><li><code>to::TimerOutputs.TimerOutput</code>: A timer output</li><li><code>silent::Bool</code>: A boolean flag to suppress progress bars</li></ul><p><strong>Returns</strong></p><ul><li><code>result_files</code>: A vector of updated result files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L245-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.synchronise_field-Tuple{Any, Dict, Any, Any, String, String}" href="#PeriLab.Solver_control.synchronise_field-Tuple{Any, Dict, Any, Any, String, String}"><code>PeriLab.Solver_control.synchronise_field</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">synchronise_field(comm, synch_fields::Dict, overlap_map, get_field, synch_field::String, direction::String)</code></pre><p>Synchronises field.</p><p><strong>Arguments</strong></p><ul><li><code>comm</code>: The MPI communicator</li><li><code>synch_fields::Dict</code>: A dictionary of fields</li><li><code>overlap_map</code>: The overlap map</li><li><code>get_field</code>: The function to get the field</li><li><code>synch_field::String</code>: The field</li><li><code>direction::String</code>: The direction</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Solver_control.jl#L301-L315">source</a></section></article><h2 id="Verlet"><a class="docs-heading-anchor" href="#Verlet">Verlet</a><a id="Verlet-1"></a><a class="docs-heading-anchor-permalink" href="#Verlet" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.calculate_strain-Tuple{Module, Union{SubArray, Vector{Int64}}, Union{Matrix{Float64}, StaticArraysCore.SMatrix, StaticArraysCore.MMatrix}}" href="#PeriLab.Solver_control.Verlet.calculate_strain-Tuple{Module, Union{SubArray, Vector{Int64}}, Union{Matrix{Float64}, StaticArraysCore.SMatrix, StaticArraysCore.MMatrix}}"><code>PeriLab.Solver_control.Verlet.calculate_strain</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_strain(datamanager::Module, nodes::Union{SubArray,Vector{Int64}}, hooke_matrix::Matrix{Float64})</code></pre><p>Calculate the von Mises stress.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li><li><code>nodes::Union{SubArray,Vector{Int64}}</code>: The nodes.</li><li><code>hooke_matrix::Matrix{Float64}</code>: The hooke matrix.</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Compute/compute_field_values.jl#L94-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.calculate_stresses-Tuple{Module, Dict{Int64, Vector{Int64}}, Dict{String, Any}}" href="#PeriLab.Solver_control.Verlet.calculate_stresses-Tuple{Module, Dict{Int64, Vector{Int64}}, Dict{String, Any}}"><code>PeriLab.Solver_control.Verlet.calculate_stresses</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_stresses(datamanager::Module, block_nodes::Dict{Int64,Vector{Int64}}, options::Dict{String, Any})</code></pre><p>Computes the stresses.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li><li><code>block_nodes::Dict{Int64,Vector{Int64}}</code>: List of block nodes.</li><li><code>options::Dict{String, Any}</code>: List of options.</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Compute/compute_field_values.jl#L117-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.calculate_von_mises_stress-Tuple{Module, Union{SubArray, Vector{Int64}}}" href="#PeriLab.Solver_control.Verlet.calculate_von_mises_stress-Tuple{Module, Union{SubArray, Vector{Int64}}}"><code>PeriLab.Solver_control.Verlet.calculate_von_mises_stress</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_von_mises_stress(datamanager::Module, nodes::Union{SubArray,Vector{Int64}})</code></pre><p>Calculate the von Mises stress.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li><li><code>nodes::Union{SubArray,Vector{Int64}}</code>: The nodes.</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Compute/compute_field_values.jl#L54-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.compute_crititical_time_step-Tuple{Module, Dict{Int64, Vector{Int64}}, Bool, Bool}" href="#PeriLab.Solver_control.Verlet.compute_crititical_time_step-Tuple{Module, Dict{Int64, Vector{Int64}}, Bool, Bool}"><code>PeriLab.Solver_control.Verlet.compute_crititical_time_step</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_crititical_time_step(datamanager::Module, block_nodes::Dict{Int64,Vector{Int64}}, mechanical::Bool, thermo::Bool)</code></pre><p>Calculate the critical time step for a simulation considering both mechanical and thermodynamic aspects.</p><p>This function computes the critical time step by considering mechanical and thermodynamic properties of different blocks. The resulting critical time step is based on the smallest critical time step found among the blocks.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Module</code>: The data manager module that provides access to required data fields and properties.</li><li><code>block_nodes::Dict{Int64, Vector{Int64}}</code>: A dictionary mapping block IDs to collections of nodes.</li><li><code>mechanical::Bool</code>: If <code>true</code>, mechanical properties are considered in the calculation.</li><li><code>thermo::Bool</code>: If <code>true</code>, thermodynamic properties are considered in the calculation.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The calculated critical time step based on the smallest critical time step found among the blocks.</li></ul><p><strong>Dependencies</strong></p><p>This function may depend on the following functions:</p><ul><li><code>compute_thermodynamic_critical_time_step</code>: Used if <code>thermo</code> is <code>true</code> to calculate thermodynamic critical time steps.</li><li><code>compute_mechanical_critical_time_step</code>: Used if <code>mechanical</code> is <code>true</code> to calculate mechanical critical time steps.</li><li>The availability of specific properties from the data manager module.</li></ul><p><strong>Errors</strong></p><ul><li>If required properties are not available in the data manager, it may raise an error message.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L163-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.compute_mechanical_critical_time_step-Tuple{Union{SubArray, Vector{Int64}}, Module, Union{Float64, Int64, SubArray, Vector{Float64}}}" href="#PeriLab.Solver_control.Verlet.compute_mechanical_critical_time_step-Tuple{Union{SubArray, Vector{Int64}}, Module, Union{Float64, Int64, SubArray, Vector{Float64}}}"><code>PeriLab.Solver_control.Verlet.compute_mechanical_critical_time_step</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_mechanical_critical_time_step(nodes::Union{SubArray,Vector{Int64}}, datamanager::Module, bulk_modulus::Float64)</code></pre><p>Calculate the critical time step for a mechanical simulation using a bond-based approximation [<a href="../references/#LittlewoodDJ2013">31</a>].</p><p>This function iterates over a collection of nodes and computes the critical time step for each node based on the given input data and parameters.</p><p><strong>Arguments</strong></p><ul><li><code>nodes::Union{SubArray, Vector{Int64}}</code>: The collection of nodes to calculate the critical time step for.</li><li><code>datamanager::Module</code>: The data manager module that provides access to required data fields.</li><li><code>bulk_modulus::Float64</code>: The bulk modulus used in the calculations.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The calculated critical time step for the mechanical simulation.</li></ul><p><strong>Dependencies</strong></p><p>This function depends on the following data fields from the <code>datamanager</code> module:</p><ul><li><code>get_nlist()</code>: Returns the neighbor list.</li><li><code>get_field(&quot;Density&quot;)</code>: Returns the density field.</li><li><code>get_field(&quot;Bond Length&quot;)</code>: Returns the bond distance field.</li><li><code>get_field(&quot;Volume&quot;)</code>: Returns the volume field.</li><li><code>get_field(&quot;Horizon&quot;)</code>: Returns the horizon field.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L98-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.compute_thermodynamic_critical_time_step-Tuple{Union{SubArray, Vector{Int64}}, Module, Union{Float64, Int64}}" href="#PeriLab.Solver_control.Verlet.compute_thermodynamic_critical_time_step-Tuple{Union{SubArray, Vector{Int64}}, Module, Union{Float64, Int64}}"><code>PeriLab.Solver_control.Verlet.compute_thermodynamic_critical_time_step</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_thermodynamic_critical_time_step(nodes::Union{SubArray,Vector{Int64}}, datamanager::Module, lambda::Float64, Cv::Float64)</code></pre><p>Calculate the critical time step for a thermodynamic simulation based on  [<a href="../references/#OterkusS2014">24</a>].</p><p>This function iterates over a collection of nodes and computes the critical time step for each node using provided input data and parameters.</p><p><strong>Arguments</strong></p><ul><li><code>nodes::Union{SubArray, Vector{Int64}}</code>: The collection of nodes to calculate the critical time step for.</li><li><code>datamanager::Module</code>: The data manager module that provides access to required data fields.</li><li><code>lambda::Float64</code>: The material parameter used in the calculations.</li><li><code>Cv::Float64</code>: The heat capacity at constant volume used in the calculations.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The calculated critical time step for the thermodynamic simulation.</li></ul><p><strong>Dependencies</strong></p><p>This function depends on the following data fields from the <code>datamanager</code> module:</p><ul><li><code>get_nlist()</code>: Returns the neighbor list.</li><li><code>get_field(&quot;Density&quot;)</code>: Returns the density field.</li><li><code>get_field(&quot;Bond Length&quot;)</code>: Returns the bond distance field.</li><li><code>get_field(&quot;Volume&quot;)</code>: Returns the volume field.</li><li><code>get_field(&quot;Number of Neighbors&quot;)</code>: Returns the number of neighbors field.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L38-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.get_cs_denominator-Tuple{Union{Vector{Float64}, Vector{Int64}, SubArray}, Union{Vector{Float64}, Vector{Int64}, SubArray}}" href="#PeriLab.Solver_control.Verlet.get_cs_denominator-Tuple{Union{Vector{Float64}, Vector{Int64}, SubArray}, Union{Vector{Float64}, Vector{Int64}, SubArray}}"><code>PeriLab.Solver_control.Verlet.get_cs_denominator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_cs_denominator(volume::Union{SubArray,Vector{Float64},Vector{Int64}}, undeformed_bond::Union{SubArray,Vector{Float64},Vector{Int64}})</code></pre><p>Calculate the denominator for the critical time step calculation.</p><p><strong>Arguments</strong></p><ul><li><code>volume::Union{SubArray,Vector{Float64},Vector{Int64}}</code>: The volume field.</li><li><code>undeformed_bond::Union{SubArray,Vector{Float64},Vector{Int64}}</code>: The undeformed bond field.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The denominator for the critical time step calculation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L82-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.get_forces_from_force_density-Tuple{Module}" href="#PeriLab.Solver_control.Verlet.get_forces_from_force_density-Tuple{Module}"><code>PeriLab.Solver_control.Verlet.get_forces_from_force_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_forces_from_force_density(datamanager::Module)</code></pre><p>Computes the forces from the force densities.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Compute/compute_field_values.jl#L12-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.get_integration_steps-Tuple{Float64, Float64, Float64}" href="#PeriLab.Solver_control.Verlet.get_integration_steps-Tuple{Float64, Float64, Float64}"><code>PeriLab.Solver_control.Verlet.get_integration_steps</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_integration_steps(initial_time::Float64, end_time::Float64, dt::Float64)</code></pre><p>Calculate the number of integration steps and the adjusted time step for a numerical integration process.</p><p><strong>Arguments</strong></p><ul><li><code>initial_time::Float64</code>: The initial time for the integration.</li><li><code>end_time::Float64</code>: The final time for the integration.</li><li><code>dt::Float64</code>: The time step size.</li></ul><p><strong>Returns</strong></p><p>A tuple <code>(nsteps, dt)</code> where:</p><ul><li><code>nsteps::Int64</code>: The number of integration steps required to cover the specified time range.</li><li><code>dt::Float64</code>: The adjusted time step size to evenly divide the time range.</li></ul><p><strong>Errors</strong></p><ul><li>Throws an error if the <code>dt</code> is less than or equal to zero.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L334-L351">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.get_partial_stresses-Tuple{Module, Union{SubArray, Vector{Int64}}}" href="#PeriLab.Solver_control.Verlet.get_partial_stresses-Tuple{Module, Union{SubArray, Vector{Int64}}}"><code>PeriLab.Solver_control.Verlet.get_partial_stresses</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_partial_stresses(datamanager::Module, nodes::Vector{Int64})</code></pre><p>Computes the partial stresses.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li><li><code>nodes::Vector{Int64}</code>: List of block nodes.</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager::Data_manager</code>: Datamanager.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Compute/compute_field_values.jl#L30-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.init_solver-Tuple{Dict{Any, Any}, Dict, Dict{Any, Any}, Module, Dict{Int64, Vector{Int64}}}" href="#PeriLab.Solver_control.Verlet.init_solver-Tuple{Dict{Any, Any}, Dict, Dict{Any, Any}, Module, Dict{Int64, Vector{Int64}}}"><code>PeriLab.Solver_control.Verlet.init_solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_solver(params::Dict, bcs::Dict{Any,Any}, datamanager::Module, block_nodes::Dict{Int64,Vector{Int64}}, mechanical::Bool, thermo::Bool)</code></pre><p>Initialize the Verlet solver for a simulation.</p><p>This function sets up the Verlet solver for a simulation by initializing various parameters and calculating the time step based on provided parameters or critical time step calculations.</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict</code>: A dictionary containing simulation parameters.</li><li><code>bcs::Dict{Any,Any}</code>: Boundary conditions</li><li><code>datamanager::Module</code>: The data manager module that provides access to required data fields and properties.</li><li><code>block_nodes::Dict{Int64,Vector{Int64}}</code>: A dictionary mapping block IDs to collections of nodes.</li><li><code>mechanical::Bool</code>: If <code>true</code>, mechanical properties are considered in the calculation.</li><li><code>thermo::Bool</code>: If <code>true</code>, thermodynamic properties are considered in the calculation.</li></ul><p><strong>Returns</strong></p><p>A tuple <code>(initial_time, dt, nsteps, numerical_damping)</code> where:</p><ul><li><code>initial_time::Float64</code>: The initial time for the simulation.</li><li><code>dt::Float64</code>: The time step for the simulation.</li><li><code>nsteps::Int64</code>: The number of time integration steps.</li><li><code>numerical_damping::Float64</code>: The numerical damping factor.</li><li><code>max_damage::Float64</code>: The maximum damage in the simulation.</li></ul><p><strong>Dependencies</strong></p><p>This function may depend on the following functions:</p><ul><li><code>get_initial_time</code>, <code>get_final_time</code>, <code>get_safety_factor</code>, <code>get_fixed_dt</code>: Used to retrieve simulation parameters.</li><li><code>compute_crititical_time_step</code>: Used to calculate the critical time step if <code>dt</code> is not fixed.</li><li><code>get_integration_steps</code>: Used to determine the number of integration steps and adjust the time step.</li><li><code>find_and_set_core_value_min</code> and <code>find_and_set_core_value_max</code>: Used to set core values in a distributed computing environment.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L248-L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.run_solver-Tuple{Dict{Any, Any}, Dict{Int64, Vector{Int64}}, Dict{Any, Any}, Module, Dict{Int64, Dict}, Vector{Dict}, Any, Any, Any, Any, TimerOutputs.TimerOutput, Bool}" href="#PeriLab.Solver_control.Verlet.run_solver-Tuple{Dict{Any, Any}, Dict{Int64, Vector{Int64}}, Dict{Any, Any}, Module, Dict{Int64, Dict}, Vector{Dict}, Any, Any, Any, Any, TimerOutputs.TimerOutput, Bool}"><code>PeriLab.Solver_control.Verlet.run_solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_solver(
    solver_options::Dict{Any,Any},
    block_nodes::Dict{Int64,Vector{Int64}},
    bcs::Dict{Any,Any},
    datamanager::Module,
    outputs::Dict{Int64,Dict{}},
    result_files::Vector{Any},
    synchronise_field,
    write_results,
    to::TimerOutputs.TimerOutput,
    silent::Bool
)</code></pre><p>Run the Verlet solver for a simulation based on the strategy provided in [<a href="../references/#BobaruF2016">1</a>] and  [<a href="../references/#LittlewoodDJ2023">3</a>].</p><p>This function performs the Verlet solver simulation, updating various data fields and properties over a specified number of time steps.</p><p><strong>Arguments</strong></p><ul><li><code>solver_options::Dict{String,Any}</code>: A dictionary containing solver options and parameters.</li><li><code>block_nodes::Dict{Int64,Vector{Int64}}</code>: A dictionary mapping block IDs to collections of nodes.</li><li><code>bcs::Dict{Any,Any}</code>: A dictionary containing boundary conditions.</li><li><code>datamanager::Module</code>: The data manager module that provides access to data fields and properties.</li><li><code>outputs::Dict{Int64,Dict{}}</code>: A dictionary for output settings.</li><li><code>result_files::Vector{Any}</code>: A vector of result files.</li><li><code>synchronise_field</code>: A function for synchronization.</li><li><code>write_results</code>: A function to write simulation results.</li><li><code>to::TimerOutputs.TimerOutput</code>: A timer output.</li><li><code>silent::Bool</code>: A boolean flag to suppress progress bars.</li></ul><p><strong>Returns</strong></p><ul><li><code>result_files</code>: A vector of updated result files.</li></ul><p><strong>Dependencies</strong></p><p>This function depends on various data fields and properties from the <code>datamanager</code> module, as well as several helper functions. It also relies on solver options and boundary conditions provided in the input parameters.</p><p><strong>Function Workflow</strong></p><ol><li>Initialize simulation parameters and data fields.</li><li>Perform Verlet integration over a specified number of time steps.</li><li>Update data fields and properties based on the solver options.</li><li>Write simulation results using the <code>write_results</code> function.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L362-L403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Verlet.test_timestep-Tuple{Float64, Float64}" href="#PeriLab.Solver_control.Verlet.test_timestep-Tuple{Float64, Float64}"><code>PeriLab.Solver_control.Verlet.test_timestep</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">test_timestep(t::Float64, critical_time_step::Float64)</code></pre><p>Compare a time step <code>t</code> with a critical time step <code>critical_time_step</code> and update <code>critical_time_step</code> if <code>t</code> is smaller.</p><p><strong>Arguments</strong></p><ul><li><code>t::Float64</code>: The time step to compare with <code>critical_time_step</code>.</li><li><code>critical_time_step::Float64</code>: The current critical time step.</li></ul><p><strong>Returns</strong></p><ul><li><code>critical_time_step::Float64</code>: The updated critical time step, which is either the original <code>critical_time_step</code> or <code>t</code>, whichever is smaller.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/Solver/Verlet.jl#L144-L155">source</a></section></article><h2 id="Boundary_conditions"><a class="docs-heading-anchor" href="#Boundary_conditions">Boundary_conditions</a><a id="Boundary_conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary_conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.apply_bc_dirichlet-Tuple{Vector{String}, Dict, Module, Float64, Float64}" href="#PeriLab.Solver_control.Boundary_conditions.apply_bc_dirichlet-Tuple{Vector{String}, Dict, Module, Float64, Float64}"><code>PeriLab.Solver_control.Boundary_conditions.apply_bc_dirichlet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_bc_dirichlet(bcs::Dict, datamanager::Module, time::Float64)</code></pre><p>Apply the boundary conditions</p><p><strong>Arguments</strong></p><ul><li><code>bcs::Dict{Any,Any}</code>: The boundary conditions</li><li><code>datamanager::Module</code>: Datamanager</li><li><code>time::Float64</code>: The current time</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager::Module</code>: Datamanager</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L154-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.apply_bc_neumann-Tuple{Dict, Module, Float64, Float64}" href="#PeriLab.Solver_control.Boundary_conditions.apply_bc_neumann-Tuple{Dict, Module, Float64, Float64}"><code>PeriLab.Solver_control.Boundary_conditions.apply_bc_neumann</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_bc_neumann(bcs::Dict, datamanager::Module, time::Float64)</code></pre><p>Apply the boundary conditions</p><p><strong>Arguments</strong></p><ul><li><code>bcs::Dict{Any,Any}</code>: The boundary conditions</li><li><code>datamanager::Module</code>: Datamanager</li><li><code>time::Float64</code>: The current time</li></ul><p><strong>Returns</strong></p><ul><li><code>datamanager::Module</code>: Datamanager</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L220-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.boundary_condition-Tuple{Dict, Any}" href="#PeriLab.Solver_control.Boundary_conditions.boundary_condition-Tuple{Dict, Any}"><code>PeriLab.Solver_control.Boundary_conditions.boundary_condition</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundary_condition(params::Dict, datamanager)</code></pre><p>Initialize the boundary condition</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict</code>: The parameters</li><li><code>datamanager::Module</code>: Datamanager</li></ul><p><strong>Returns</strong></p><ul><li><code>bcs_out::Dict{Any,Any}</code>: The boundary conditions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L116-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.check_valid_bcs-Tuple{Dict{String, Any}, Module}" href="#PeriLab.Solver_control.Boundary_conditions.check_valid_bcs-Tuple{Dict{String, Any}, Module}"><code>PeriLab.Solver_control.Boundary_conditions.check_valid_bcs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_valid_bcs(bcs::Dict{String,Any}, datamanager::Module</code></pre><p>Check if the boundary conditions are valid</p><p><strong>Arguments</strong></p><ul><li><code>bcs::Dict{String,Any}</code>: The boundary conditions</li><li><code>datamanager::Module</code>: The data manager module</li></ul><p><strong>Returns</strong></p><ul><li><code>working_bcs::Dict{String,Any}</code>: The valid boundary conditions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L40-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.clean_up-Tuple{String}" href="#PeriLab.Solver_control.Boundary_conditions.clean_up-Tuple{String}"><code>PeriLab.Solver_control.Boundary_conditions.clean_up</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clean_up(bc::String)</code></pre><p>Clean up the boundary condition</p><p><strong>Arguments</strong></p><ul><li><code>bc::String</code>: The boundary condition</li></ul><p><strong>Returns</strong></p><ul><li><code>bc::String</code>: The cleaned up boundary condition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L277-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.eval_bc!" href="#PeriLab.Solver_control.Boundary_conditions.eval_bc!"><code>PeriLab.Solver_control.Boundary_conditions.eval_bc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_bc!(field_values::Union{Vector{Float64},Vector{Int64}}, bc::Union{Float64,Float64,Int64,String}, coordinates::Matrix{Float64}, time::Float64, dof::Int64)</code></pre><p>Working with if-statements &quot;if t&gt;2 0 else 20 end&quot; works for scalars. If you want to evaluate a vector, please use the Julia notation as input &quot;ifelse.(x .&gt; y, 10, 20)&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L316-L322">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.find_bc_free_dof-Tuple{Module, Dict{Any, Any}}" href="#PeriLab.Solver_control.Boundary_conditions.find_bc_free_dof-Tuple{Module, Dict{Any, Any}}"><code>PeriLab.Solver_control.Boundary_conditions.find_bc_free_dof</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_bc_free_dof(datamanager::Module, bcs::Dict{String,Any})</code></pre><p>Finds all dof without a displacement boundary condition. This tuple vector is stored in the datamanager.</p><p><strong>Arguments</strong></p><ul><li><code>datamanager::Module</code>: The data manager module</li><li><code>bcs::Dict{String,Any}</code>: The boundary conditions</li></ul><p><strong>Returns</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L14-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PeriLab.Solver_control.Boundary_conditions.init_BCs-Tuple{Dict, Any}" href="#PeriLab.Solver_control.Boundary_conditions.init_BCs-Tuple{Dict, Any}"><code>PeriLab.Solver_control.Boundary_conditions.init_BCs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_BCs(params::Dict, datamanager)</code></pre><p>Initialize the boundary conditions</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict</code>: The parameters</li><li><code>datamanager::Module</code>: Datamanager</li></ul><p><strong>Returns</strong></p><ul><li><code>bcs::Dict{Any,Any}</code>: The boundary conditions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeriHub/PeriLab.jl/blob/18497c7688527f9933f4467f52f506bed6c3d84d/src/Core/BC_manager.jl#L99-L109">source</a></section></article><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../data_manager_functions/">« Data Manager</a><a class="docs-footer-nextpage" href="../io_functions/">IO »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.2 on <span class="colophon-date" title="Wednesday 14 May 2025 14:16">Wednesday 14 May 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
