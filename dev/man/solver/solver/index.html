<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solver · PeriLab</title><meta name="title" content="Solver · PeriLab"/><meta property="og:title" content="Solver · PeriLab"/><meta property="twitter:title" content="Solver · PeriLab"/><meta name="description" content="Documentation for PeriLab."/><meta property="og:description" content="Documentation for PeriLab."/><meta property="twitter:description" content="Documentation for PeriLab."/><meta property="og:url" content="https://github.com/PeriHub/PeriLab.jl/man/solver/solver/"/><meta property="twitter:url" content="https://github.com/PeriHub/PeriLab.jl/man/solver/solver/"/><link rel="canonical" href="https://github.com/PeriHub/PeriLab.jl/man/solver/solver/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="PeriLab logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="PeriLab logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">PeriLab</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../basics/">First Steps with PeriLab</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../input_yaml/">Input File</a></li><li><a class="tocitem" href="../../mesh_input/">Mesh and Nodesets</a></li><li><a class="tocitem" href="../../bond_filter/">Bond-Filter</a></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../models/overview/">Overview</a></li><li><a class="tocitem" href="../../models/materials/">Material Models</a></li><li><a class="tocitem" href="../../models/damage/">Damage Models</a></li><li><a class="tocitem" href="../../models/thermal/">Thermal Models</a></li><li><a class="tocitem" href="../../models/additive/">Additive Models</a></li></ul></li><li><a class="tocitem" href="../../output/">Output</a></li><li class="is-active"><a class="tocitem" href>Solver</a><ul class="internal"><li><a class="tocitem" href="#Verlet"><span>Verlet</span></a></li><li><a class="tocitem" href="#Static"><span>Static</span></a></li></ul></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../../theory/theory/">Basics</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Peridynamic Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../theory/theory_bondbased/">Bond-based</a></li><li><a class="tocitem" href="../../../theory/theory_ordinary/">Ordinary state-based</a></li><li><a class="tocitem" href="../../../theory/theory_correspondence/">Non-Ordinary state-based</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Multi-Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../theory/theory_thermal/">Thermal Models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Finite Element Method</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../theory/theory_FEM/">FEM</a></li><li><a class="tocitem" href="../../../theory/theory_FEM_PD_coupling/">Finite Element - Peridynamics coupling</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Modelling strategies</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../theory/theory_surface_correction/">Surface Correction</a></li></ul></li></ul></li><li><span class="tocitem">Lecture</span><ul><li><a class="tocitem" href="../../../lecture/lecture/">Non-local structural mechanics and peridynamics</a></li><li><a class="tocitem" href="../../../lecture/seminar_1/">Seminar 1</a></li><li><a class="tocitem" href="../../../lecture/seminar_2/">Seminar 2</a></li></ul></li><li><a class="tocitem" href="../../../lib/faq/">FAQ</a></li><li><a class="tocitem" href="../../../lib/glossar/">Glossar</a></li><li><a class="tocitem" href="../../../lib/references/">References</a></li><li><a class="tocitem" href="../../../lib/links/">Useful Links</a></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="../../dev/developement_guide/">Guide</a></li><li><a class="tocitem" href="../../dev/datamanager/">Datamanager</a></li><li><a class="tocitem" href="../../dev/module_integration/">Module integration</a></li><li><a class="tocitem" href="../../dev/testing/">Software Testing</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../../lib/model_factory_functions/">Model Factory</a></li><li><a class="tocitem" href="../../../lib/data_manager_functions/">Data Manager</a></li><li><a class="tocitem" href="../../../lib/solver_functions/">Solver</a></li><li><a class="tocitem" href="../../../lib/io_functions/">IO</a></li><li><a class="tocitem" href="../../../lib/geometry_functions/">Geometry</a></li><li><a class="tocitem" href="../../../lib/mpi_functions/">MPI</a></li><li><a class="tocitem" href="../../../lib/helper_functions/">Helper</a></li><li><a class="tocitem" href="../../../lib/logging_functions/">Logging</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solver</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PeriHub/PeriLab.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PeriHub/PeriLab.jl/blob/main/docs/src/man/solver/solver.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solver"><a class="docs-heading-anchor" href="#Solver">Solver</a><a id="Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Solver" title="Permalink"></a></h1><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Optional</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right">Material Models</td><td style="text-align: right">Bool</td><td style="text-align: right">Yes</td><td style="text-align: right">Activates the time integration for materials and material evaluation</td></tr><tr><td style="text-align: right">Damage Models</td><td style="text-align: right">Bool</td><td style="text-align: right">Yes</td><td style="text-align: right">Activates the damage evaluation</td></tr><tr><td style="text-align: right">Thermal Models</td><td style="text-align: right">Bool</td><td style="text-align: right">Yes</td><td style="text-align: right">Activates the time integration for thermal models and thermal model evaluation</td></tr><tr><td style="text-align: right">Additive Models</td><td style="text-align: right">Bool</td><td style="text-align: right">Yes</td><td style="text-align: right">Activates the additive model evaluation</td></tr><tr><td style="text-align: right">Maximum Damage</td><td style="text-align: right">Float</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines the maximum damage in one point</td></tr><tr><td style="text-align: right">Initial Time</td><td style="text-align: right">Float</td><td style="text-align: right">No</td><td style="text-align: right">Defines the initial time</td></tr><tr><td style="text-align: right">Final Time</td><td style="text-align: right">Float</td><td style="text-align: right">No</td><td style="text-align: right">Defines the final time</td></tr><tr><td style="text-align: right">Fixed dt</td><td style="text-align: right">Float</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines a fixed time step</td></tr><tr><td style="text-align: right">Number of Steps</td><td style="text-align: right">Int</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines a fixed number of steps</td></tr><tr><td style="text-align: right">Verlet</td><td style="text-align: right">Dict</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines the Verlet solver</td></tr><tr><td style="text-align: right">Static</td><td style="text-align: right">Dict</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines the Static solver</td></tr></table><h2 id="Verlet"><a class="docs-heading-anchor" href="#Verlet">Verlet</a><a id="Verlet-1"></a><a class="docs-heading-anchor-permalink" href="#Verlet" title="Permalink"></a></h2><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Optional</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right">Safety Factor</td><td style="text-align: right">Float</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines a scaling factor for the time increment</td></tr><tr><td style="text-align: right">Numerical Damping</td><td style="text-align: right">Float</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines a damping factor</td></tr></table><div class="admonition is-warning"><header class="admonition-header">Fixed dt</header><div class="admonition-body"><p>If a fixed time step is defined, the time integration can become unstable.</p></div></div><p>The Verlet time integration is used as standard solver for dynamic hyperbolic differential equation of motion. It is also used in Peridigm [<a href="../../../lib/references/#LittlewoodDJ2023">2</a>]. The displacements for step <span>$i+1$</span> are solved as follows</p><p class="math-container">\[\mathbf{u}_{i+1} = \mathbf{u}_{i} + \Delta t\dot{\mathbf{u}}_{i} + \frac12 \Delta t^2\ddot{\mathbf{u}}_{i}\]</p><p>with</p><p class="math-container">\[\ddot{\mathbf{u}}_{i} = \frac{\mathbf{F}_i}{\rho}\]</p><p>where <span>$\rho$</span> is the mass density of the point and <span>$\mathbf{F}_i=\mathbf{F}_{external}-\mathbf{F}_{internal}$</span> for the current time step.</p><p>For parabolic hyperbolic time integration as in temperature models the following schema is used</p><p class="math-container">\[\boldsymbol{\tau}_{i+1} =  \boldsymbol{\tau}_i - \Delta t \frac{\mathbf{H}}{\rho C_v}\]</p><p>where <span>$\rho$</span> is the mass density, <span>$C_v$</span> is the <a href="https://en.wikipedia.org/wiki/Specific_heat_capacity">specific heat capacity</a> and <span>$\mathbf{H}$</span> is the heat flux of each point [<a href="../../../lib/references/#OterkusS2014b">9</a>].</p><p>For the time intergration a stable increment has to be determined.</p><h2 id="Static"><a class="docs-heading-anchor" href="#Static">Static</a><a id="Static-1"></a><a class="docs-heading-anchor-permalink" href="#Static" title="Permalink"></a></h2><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Optional</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right">NLsolve</td><td style="text-align: right">Bool</td><td style="text-align: right">Yes</td><td style="text-align: right">Place Holder</td></tr><tr><td style="text-align: right">Solution tolerance</td><td style="text-align: right">Float</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines how much change between two iterations of the solution variable is allowed.</td></tr><tr><td style="text-align: right">Residual tolerance</td><td style="text-align: right">Float</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines how much change between two iterations of the maximum residual variable is allowed.</td></tr><tr><td style="text-align: right">Maximum number of iterations</td><td style="text-align: right">Int</td><td style="text-align: right">Yes</td><td style="text-align: right">Maximum number of iteration of the solver.</td></tr><tr><td style="text-align: right">Show solver iteration</td><td style="text-align: right">Bool</td><td style="text-align: right">Yes</td><td style="text-align: right">Shows additional information</td></tr><tr><td style="text-align: right">Residual scaling</td><td style="text-align: right">Float</td><td style="text-align: right">Yes</td><td style="text-align: right">Scales the residual and the variable in same order. Should be in the range of the Young&#39;s modulus.</td></tr><tr><td style="text-align: right">Solver Type</td><td style="text-align: right">String</td><td style="text-align: right">Yes</td><td style="text-align: right">not implmented yet</td></tr><tr><td style="text-align: right">m</td><td style="text-align: right">Int</td><td style="text-align: right">Yes</td><td style="text-align: right">Only for Anderson solver;  It does not use Jacobian information or linesearch, but has a history whose size is controlled by the m parameter: <span>$m=0$</span> corresponds to the simple fixed-point iteration above, and higher values use a larger history size to accelerate the iterations. Higher values of m usually increase the speed of convergence, but increase the storage and computation requirements and might lead to instabilities. <span>$m=15$</span> is set as standard value.</td></tr><tr><td style="text-align: right">Linear Start Value</td><td style="text-align: right">Vector{Float}</td><td style="text-align: right">Yes</td><td style="text-align: right">Defines start and end values of a linear function over the length of the model (detailed explanation in the text)</td></tr></table><p>The static solver from <a href="https://github.com/JuliaNLSolvers/NLsolve.jl">NLsolve.jl</a> has been included. Specifically the <a href="https://github.com/JuliaNLSolvers/NLsolve.jl#anderson-acceleration">method = :anderson</a> is used.</p><p>The solver computes the residual of the internal reaction force densities and the external applied force densities <span>$r =  \left[\underline{\mathbf{T}}_{external} + \underline{\mathbf{T}}_{internal}\right] / s_{Residual\,scaling}$</span></p><p>Right now the default value <span>$m$</span> of the Anderson acceleration method is chosen.</p><p class="math-container">\[s_{Residual\,scaling}\]</p><p>should be in the range of the Young&#39;s modulus and is than scaled by the volume.</p><p class="math-container">\[s_{Residual\,scaling} /= minimum(volume)^2\]</p><div class="admonition is-warning"><header class="admonition-header">Multiphysics</header><div class="admonition-body"><p>Currently only the mechanical solver is included!</p></div></div><hr/><p><strong>Start Value</strong></p><p>The start value defines the values taken for the first iteration. The default is zero. Two options are possible. The first option defines start values in the mesh file. The name is</p><pre><code class="nohighlight hljs">start_values_x
start_values_y
start_values_z (optional)</code></pre><p>These numbers are stored in the datamanager and are used for the iteration.</p><p>The alternative is to define a Linear Start Value as it is given as option in the list above. This list defines values for 3D as</p><p class="math-container">\[start_{val} = [A_{x-min}\,A_{x-max}\,A_{y-min}\,A_{y-max}\,A_{z-min}\,A_{z-max}]\]</p><p>and for 2D</p><p class="math-container">\[start_{val} = [A_{x-min}\,A_{x-max}\,A_{y-min}\,A_{y-max}]\]</p><p>where <span>$A$</span> are amplitude values chosen by the user.</p><p>With these values the field &#39;&#39;start_values&#39;&#39; is computed as</p><p class="math-container">\[start\_value(x,y,z (optional))= \frac{a(x,y,z(optional))\cdot coordinates+n(x,y,z(optional))}{nsteps}\]</p><p class="math-container">\[a(x,y,z (optional))=\frac{\text{max}(start_{val})-\text{min}(start_{val})}{\text{max}(coordinates)-\text{min}(coordinates)}\]</p><p>and</p><p class="math-container">\[n(x,y,z (optional))=\text{max}(start_{val})-a(x,y,z (optional))\text{max}(coordinates)\]</p><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../output/">« Output</a><a class="docs-footer-nextpage" href="../../../theory/theory/">Basics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 24 April 2025 15:03">Thursday 24 April 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
