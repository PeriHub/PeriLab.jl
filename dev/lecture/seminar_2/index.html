<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Seminar 2 · PeriLab</title><meta name="title" content="Seminar 2 · PeriLab"/><meta property="og:title" content="Seminar 2 · PeriLab"/><meta property="twitter:title" content="Seminar 2 · PeriLab"/><meta name="description" content="Documentation for PeriLab."/><meta property="og:description" content="Documentation for PeriLab."/><meta property="twitter:description" content="Documentation for PeriLab."/><meta property="og:url" content="https://github.com/PeriHub/PeriLab.jl/lecture/seminar_2/"/><meta property="twitter:url" content="https://github.com/PeriHub/PeriLab.jl/lecture/seminar_2/"/><link rel="canonical" href="https://github.com/PeriHub/PeriLab.jl/lecture/seminar_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="PeriLab logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="PeriLab logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PeriLab</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../man/basics/">First Steps with PeriLab</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../man/getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../man/input_yaml/">Input File</a></li><li><a class="tocitem" href="../../man/mesh_input/">Mesh and Nodesets</a></li><li><a class="tocitem" href="../../man/bond_filter/">Bond-Filter</a></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/models/overview/">Overview</a></li><li><a class="tocitem" href="../../man/models/materials/">Material Models</a></li><li><a class="tocitem" href="../../man/models/damage/">Damage Models</a></li><li><a class="tocitem" href="../../man/models/thermal/">Thermal Models</a></li><li><a class="tocitem" href="../../man/models/additive/">Additive Models</a></li><li><a class="tocitem" href="../../man/models/contact/">Contact Models</a></li></ul></li><li><a class="tocitem" href="../../man/output/">Output</a></li><li><a class="tocitem" href="../../man/solver/solver/">Solver</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/theory/">Basics</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Peridynamic Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_bondbased/">Bond-based</a></li><li><a class="tocitem" href="../../theory/theory_ordinary/">Ordinary state-based</a></li><li><a class="tocitem" href="../../theory/theory_correspondence/">Non-Ordinary state-based</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Multi-Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_thermal/">Thermal Models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Finite Element Method</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_FEM/">FEM</a></li><li><a class="tocitem" href="../../theory/theory_FEM_PD_coupling/">Finite Element - Peridynamics coupling</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Modelling strategies</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../theory/theory_surface_correction/">Surface Correction</a></li></ul></li></ul></li><li><span class="tocitem">Non-local structural mechanics and peridynamics</span><ul><li><a class="tocitem" href="../lecture/">Course Description</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox" checked/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Seminars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../seminar_1/">Seminar 1</a></li><li class="is-active"><a class="tocitem" href>Seminar 2</a><ul class="internal"><li><a class="tocitem" href="#Seminar-2:-Material-point-method-and-solver"><span>Seminar 2: Material point method and solver</span></a></li><li><a class="tocitem" href="#Equations-in-the-Quasi-Static-Material-Point-Method-Algorithm"><span>Equations in the Quasi-Static Material Point Method Algorithm</span></a></li><li class="toplevel"><a class="tocitem" href="#Volume-correction"><span>Volume correction</span></a></li><li><a class="tocitem" href="#Set-up-your-own-model"><span>Set up your own model</span></a></li></ul></li><li><a class="tocitem" href="../seminar_3/">Seminar 3</a></li><li><a class="tocitem" href="../seminar_4/">Seminar 4</a></li><li><a class="tocitem" href="../seminar_5/">Seminar 5</a></li></ul></li></ul></li><li><a class="tocitem" href="../../lib/faq/">FAQ</a></li><li><a class="tocitem" href="../../lib/glossar/">Glossar</a></li><li><a class="tocitem" href="../../lib/references/">References</a></li><li><a class="tocitem" href="../../lib/links/">Useful Links</a></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="../../man/dev/developement_guide/">Guide</a></li><li><a class="tocitem" href="../../man/dev/datamanager/">Datamanager</a></li><li><a class="tocitem" href="../../man/dev/module_integration/">Module integration</a></li><li><a class="tocitem" href="../../man/dev/testing/">Software Testing</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../lib/model_factory_functions/">Model Factory</a></li><li><a class="tocitem" href="../../lib/data_manager_functions/">Data Manager</a></li><li><a class="tocitem" href="../../lib/solver_functions/">Solver</a></li><li><a class="tocitem" href="../../lib/io_functions/">IO</a></li><li><a class="tocitem" href="../../lib/geometry_functions/">Geometry</a></li><li><a class="tocitem" href="../../lib/mpi_functions/">MPI</a></li><li><a class="tocitem" href="../../lib/helper_functions/">Helper</a></li><li><a class="tocitem" href="../../lib/logging_functions/">Logging</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Non-local structural mechanics and peridynamics</a></li><li><a class="is-disabled">Seminars</a></li><li class="is-active"><a href>Seminar 2</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Seminar 2</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PeriHub/PeriLab.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PeriHub/PeriLab.jl/blob/main/docs/src/lecture/seminar_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Seminar-2:-Material-point-method-and-solver"><a class="docs-heading-anchor" href="#Seminar-2:-Material-point-method-and-solver">Seminar 2: Material point method and solver</a><a id="Seminar-2:-Material-point-method-and-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Seminar-2:-Material-point-method-and-solver" title="Permalink"></a></h2><ul><li>particle method</li><li>points are grid fix (no pure mesh free method)</li></ul><p><strong>Advantage</strong></p><ul><li>no topology</li><li>disconnection of points is easy</li></ul><p><strong>Disadvantage</strong></p><ul><li>convergence is low</li><li>gradients purely described by points</li></ul><h2 id="Equations-in-the-Quasi-Static-Material-Point-Method-Algorithm"><a class="docs-heading-anchor" href="#Equations-in-the-Quasi-Static-Material-Point-Method-Algorithm">Equations in the Quasi-Static Material Point Method Algorithm</a><a id="Equations-in-the-Quasi-Static-Material-Point-Method-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Equations-in-the-Quasi-Static-Material-Point-Method-Algorithm" title="Permalink"></a></h2><h4 id="**1.-Mapping-Material-Point-Quantities-to-Grid-Nodes**"><a class="docs-heading-anchor" href="#**1.-Mapping-Material-Point-Quantities-to-Grid-Nodes**"><strong>1. Mapping Material Point Quantities to Grid Nodes</strong></a><a id="**1.-Mapping-Material-Point-Quantities-to-Grid-Nodes**-1"></a><a class="docs-heading-anchor-permalink" href="#**1.-Mapping-Material-Point-Quantities-to-Grid-Nodes**" title="Permalink"></a></h4><ul><li><strong>Nodal Mass</strong></li></ul><p class="math-container">\[M_{\text{node}} = \sum_{mp} m_{mp} \, N_{mp-nd}\]</p><ul><li><strong>Nodal Velocity</strong></li></ul><p class="math-container">\[\mathbf{V}_{\text{node}} = \frac{1}{M_{\text{node}}} \sum_{mp} \mathbf{P}_{mp} \, N_{mp-nd}\]</p><ul><li><strong>Internal Force Vector</strong></li></ul><p class="math-container">\[\mathbf{F}_{\text{node}}^{\text{internal}} = \sum_{mp} \boldsymbol{\sigma}_{mp} \, \nabla N_{mp-nd}\]</p><ul><li><strong>External Force Vector</strong></li></ul><p class="math-container">\[\mathbf{F}_{\text{node}}^{\text{external}} = \sum_{mp} \mathbf{b} \, N_{mp-nd}\]</p><h4 id="**2.-Solving-Equations-of-Motion-on-the-Grid**"><a class="docs-heading-anchor" href="#**2.-Solving-Equations-of-Motion-on-the-Grid**"><strong>2. Solving Equations of Motion on the Grid</strong></a><a id="**2.-Solving-Equations-of-Motion-on-the-Grid**-1"></a><a class="docs-heading-anchor-permalink" href="#**2.-Solving-Equations-of-Motion-on-the-Grid**" title="Permalink"></a></h4><ul><li><strong>Nodal Acceleration</strong></li></ul><p class="math-container">\[\mathbf{A}_{\text{node}} = \frac{\mathbf{F}_{\text{node}}^{\text{external}} + \mathbf{F}_{\text{node}}^{\text{internal}}}{M_{\text{node}}}\]</p><ul><li><strong>Updated Nodal Velocity</strong></li></ul><p class="math-container">\[\tilde{\mathbf{V}}_{\text{node}} = \mathbf{V}_{\text{node}} + \mathbf{A}_{\text{node}} \, \mathrm{d}t\]</p><h4 id="**3.-Mapping-Back-to-Material-Points**"><a class="docs-heading-anchor" href="#**3.-Mapping-Back-to-Material-Points**"><strong>3. Mapping Back to Material Points</strong></a><a id="**3.-Mapping-Back-to-Material-Points**-1"></a><a class="docs-heading-anchor-permalink" href="#**3.-Mapping-Back-to-Material-Points**" title="Permalink"></a></h4><ul><li><strong>Material Point Acceleration</strong></li></ul><p class="math-container">\[\mathbf{a}_{mp} = \sum_{nd} \mathbf{A}_{\text{node}} \, N_{nd-mp}\]</p><ul><li><strong>Strain Rate (Infinitesimal Strain Theory)</strong></li></ul><p class="math-container">\[\dot{\boldsymbol{\varepsilon}}_{mp} = \sum_{nd} \frac{1}{2} \left[ \mathbf{V}_{\text{node}} \nabla N_{nd-mp} + (\mathbf{V}_{\text{node}} \nabla N_{nd-mp})^T \right]\]</p><hr/><p><img src="../../assets/collocation_points.png" alt/></p><hr/><p><img src="../../assets/increasing_stiff.png" alt/> Figure taken from [<a href="../../lib/references/#BeuthL2012">2</a>].</p><hr/><p class="math-container">\[\rho \ddot{u}_i = \frac{1}{2}\sum_j (f_{ji}V_i-f_{ij}V_j)+b_i\]</p><p class="math-container">\[F_i + b_i=\rho\ddot{u}_i\]</p><p><strong>Static case</strong></p><p><img src="../../assets/newton_raphson.png" alt/> Figure taken from [<a href="../../lib/references/#BeuthL2012">2</a>].</p><p class="math-container">\[\mathbf{F}(\mathbf{u}_{i+1}) + \mathbf{b}_{i+1} \rightarrow 0\]</p><hr/><p><strong>Verlet time integration</strong></p><p class="math-container">\[\mathbf{u}_{i+1} = \mathbf{u}_{i} + \Delta t\dot{\mathbf{u}}_{i} + \frac12 \Delta t^2\ddot{\mathbf{u}}_{i}\]</p><p>with</p><p class="math-container">\[\ddot{\mathbf{u}}_{i} = \frac{\mathbf{F}_i}{\rho}\]</p><p>where <span>$\rho$</span> is the mass density of the point and <span>$\mathbf{F}_i=\mathbf{F}_{external}-\mathbf{F}_{internal}$</span> for the current time step.</p><p>For parabolic  time integration as in temperature models the following schema is used</p><p class="math-container">\[\boldsymbol{\tau}_{i+1} =  \boldsymbol{\tau}_i - \Delta t \frac{\mathbf{H}}{\rho C_v}\]</p><p>where <span>$\rho$</span> is the mass density, <span>$C_v$</span> is the <a href="https://en.wikipedia.org/wiki/Specific_heat_capacity">specific heat capacity</a> and <span>$\mathbf{H}$</span> is the heat flux of each point [<a href="../../lib/references/#OterkusS2014b">10</a>].</p><p>For the time intergration a stable increment has to be determined.</p><h1 id="Volume-correction"><a class="docs-heading-anchor" href="#Volume-correction">Volume correction</a><a id="Volume-correction-1"></a><a class="docs-heading-anchor-permalink" href="#Volume-correction" title="Permalink"></a></h1><p><img src="../../assets/volume_correction.png" alt/></p><p class="math-container">\[\lambda_{corr}=\frac{2V_0}{V(\mathbf{x})+V(\mathbf{x}&#39;)}\]</p><p>The reference volumen <span>$V_0$</span> is depended on the dimension (3D or 2D)</p><p class="math-container">\[V_{0-3D}=\frac{4\pi\delta^3}{3}\]</p><p class="math-container">\[V_{0-2D}=\frac{\pi\delta^2h}{4}\]</p><p>this factor is than multiplied to the bond force <span>$\mathbf{t}_{corr} =\lambda_{corr}\mathbf{t}$</span></p><div class="admonition is-category-warn" id="Only-mechanical-61db28f05a448024"><header class="admonition-header">Only mechanical<a class="admonition-anchor" href="#Only-mechanical-61db28f05a448024" title="Permalink"></a></header><div class="admonition-body"><p>Surface correction is right now only applied for mechanical properties.</p></div></div><p>You can apply the surface correction initialy for all outer surfaces and continuous, for cracks or additive manufacturing.</p><pre><code class="language-julia hljs">using Plots
using Polynomials

# Definition des Intervalls
x = range(0, π, length=200)
y = sin.(x)

# Plot vorbereiten
plot(x, y,
    label=&quot;sin(x)&quot;,
    lw=2,
    legend=:bottomleft,
    xlabel=&quot;x&quot;,
    ylabel=&quot;y&quot;,
    size=(1200, 800))

# Anzahl der Stützstellen
n_nodes = 8
x_nodes = range(0, π, length=n_nodes)
y_nodes = sin.(x_nodes)

# Approximation mit Polynomen 2. bis 7. Ordnung
for deg in 1:3
    # Polynomanpassung
    p = fit(x_nodes, y_nodes, deg)
    y_approx = p.(x)
    plot!(x, y_approx, label=&quot;Grad $deg&quot;)
end

# Punkte anzeigen
scatter!(x_nodes, y_nodes, label=&quot;Exact solution&quot;, color=:black)</code></pre><hr/><h2 id="Set-up-your-own-model"><a class="docs-heading-anchor" href="#Set-up-your-own-model">Set up your own model</a><a id="Set-up-your-own-model-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-your-own-model" title="Permalink"></a></h2><pre><code class="language-plaintext hljs">header: x y block_id volume
0 0 1 1
1 0 1 1
2 0 1 1
3 0 1 1
4 0 1 1</code></pre><pre><code class="language-julia hljs">function generate_grid_fixed_spacing(filename, x_from, x_to, y_from, y_to, dx; block_id=1)

    num_points_x = Int(floor((x_to - x_from) / dx)) + 1
    num_points_y = Int(floor((y_to - y_from) / dx)) + 1
    volume = dx * dx

    open(filename, &quot;w&quot;) do io
        println(io, &quot;header: x y block_id volume&quot;)
        for j in 0:num_points_y-1
            y = y_from + j * dx
            for i in 0:num_points_x-1
                x = x_from + i * dx
                println(io, &quot;$(x) $(y) $(block_id) $(volume)&quot;)
            end
        end
    end
end</code></pre><pre><code class="language-yaml hljs">PeriLab:
  Discretization:
    Node Sets:
      Node Set 1: 1
      Node Set 2: 5
    Type: &quot;Text File&quot;
    Input Mesh File: &quot;truss.txt&quot;
  Models:
    Material Models:
      Test:
        Material Model: &quot;Bond-based Elastic&quot;
        Symmetry: &quot;isotropic plane stress&quot;
        Young&#39;s Modulus: 7000
        Poisson&#39;s Ratio: 0.3
  Blocks:
    block_1:
      Block ID: 1
      Material Model: &quot;Test&quot;
      Density: 2e-9
      Horizon: 2
  Boundary Conditions:
    BC_1:
      Variable: &quot;Displacements&quot;
      Node Set: &quot;Node Set 1&quot;
      Coordinate: &quot;x&quot;
      Value: &quot;100*t&quot;
      Type: Dirichlet
    BC_2:
      Variable: &quot;Displacements&quot;
      Coordinate: &quot;x&quot;
      Node Set: &quot;Node Set 2&quot;
      Value: &quot;0.1*t&quot;
      Type: Dirichlet
  Solver:
    Material Models: True
    Initial Time: 0.0
    Final Time: 1.0
    Number of Steps: 20
    Static:
      Show solver iteration: true
      Residual tolerance: 1e-7
      Solution tolerance: 1e-8
      Residual scaling: 7000
      m: 550
      Maximum number of iterations: 100
  Outputs:
    Output1:
      Output Filename: &quot;truss&quot;
      Output File Type: Exodus
      Number of Output Steps: 20
      Output Variables:
        Displacements: True
        Number of Neighbors: True
        Forces: True</code></pre><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../seminar_1/">« Seminar 1</a><a class="docs-footer-nextpage" href="../seminar_3/">Seminar 3 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 6 June 2025 09:09">Friday 6 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
